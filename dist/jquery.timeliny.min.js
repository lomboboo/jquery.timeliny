!function(e,t,a,i){"use strict";function n(n,s){function r(){D("onInit"),o(),s.hideBlankYears===!1&&l(),d(),u(),f(),h(),p(),y(),m(),v(),g(),N(),c()}function o(){X.detach().sort(function(t,a){return"asc"===s.order?e(t).data("year")-e(a).data("year"):e(a).data("year")-e(t).data("year")}),z.append(X)}function c(){var e=z.find("."+s.className+"-timeblock.active").first().attr("data-year");D("afterLoad",[e]),z.addClass("loaded")}function l(){var e=parseInt(X.first().attr("data-year")),t=parseInt(X.last().attr("data-year"));if("asc"===s.order)for(var a=e-s.boundaries;a<t+s.boundaries+1;a++)X.parent().find("[data-year="+a+"]").length<=0&&(a>e-s.boundaries?X.parent().find("[data-year="+(a-1)+"]").after('<div data-year="'+a+'" class="inactive"></div>'):X.first().before('<div data-year="'+a+'" class="inactive"></div>'));else for(var a=e+s.boundaries;a>=t-s.boundaries;a--)X.parent().find("[data-year="+a+"]").length<=0&&(a<e+s.boundaries?X.parent().find("[data-year="+(a+1)+"]").after('<div data-year="'+a+'" class="inactive"></div>'):X.first().before('<div data-year="'+a+'" class="inactive"></div>'));X=z.children()}function d(){return z.addClass(s.className).children().wrapAll(s.wrapper).wrapAll('<div class="'+s.className+'-timeline"></div>')}function f(){var e=.8*z.css("padding-top").replace("px","");z.find("."+s.className+"-timeline").css("width",""+X.length*e+"px"),z.find("."+s.className+"-timeliny-timeblock").css("width",""+e+"px")}function u(){X.each(function(t){var a=e(this).html(),i=e(this).attr("data-year"),n='<a href="#'+i+'" class="'+s.className+'-dot" data-year="'+i+'" data-text="'+a+'"></a><span class="'+s.className+'-circle"></span>';e(this).addClass(""+s.className+"-timeblock").html(n)})}function m(){var e=s.disableVerticalLine?"opacity: 0; position:absolute;z-index: -99999;":"";z.append('<div class="'+s.className+'-vertical-line" style="'+e+'"></div>')}function v(e){var t,a=z.find("."+s.className+"-vertical-line").position().left,i=z.find("."+s.className+"-timeblock.active").position().left,n=z.find("."+s.className+"-timeblock.active ."+s.className+"-dot").width()/2,r=i-a;t=r>0?"-"+(Math.abs(r)+n+1):"+"+(Math.abs(r)-n-1),z.find("."+s.className+"-timeline").animate({left:t},s.animationSpeed,function(){if("undefined"!=typeof e)if("click"===e){var t=z.find("."+s.className+"-timeblock.active").first().attr("data-year");D("afterChange",[t])}else"resize"===e&&D("afterResize")})}function h(){X.parent().find("."+s.className+"-timeblock:not(.inactive) ."+s.className+"-dot").on("click touchstart",function(t){t.preventDefault();var a=e(this).parent().parent().find("."+s.className+"-timeblock.active").attr("data-year"),i=e(this).attr("data-year");return a!=i&&(D("onLeave",[a,i]),X.removeClass("active"),e(this).closest("."+s.className+"-timeblock").addClass("active")),v("click"),!1})}function p(){var t=s.distance||30;X.each(function(a){var i=e(this).attr("data-year"),n=e(this).next().attr("data-year"),s=(parseInt(n,10)-parseInt(i,10))*t;e(this).css("margin-right",s)})}function y(){e("html").keydown(function(t){if(39==t.which){var a=e(this).find("."+s.className+"-timeblock:not(.inactive) ."+s.className+"-dot"),i=(e(a).parent().parent().find("."+s.className+"-timeblock.active").attr("data-year"),e(a).parent().parent().find("."+s.className+"-timeblock.active").next().attr("data-year"));k(i)}else if(37==t.which){var a=e(this).find("."+s.className+"-timeblock:not(.inactive) ."+s.className+"-dot"),n=(e(a).parent().parent().find("."+s.className+"-timeblock.active").attr("data-year"),e(a).parent().parent().find("."+s.className+"-timeblock.active").prev().attr("data-year"));k(n)}})}function g(){function a(e,t){var a;return function(){var i=arguments,n=this;clearTimeout(a),a=setTimeout(function(){e.apply(n,i)},t)}}e(t).on("resize.timeliny",a(function(){v("resize")},350))}function N(){function n(e,t){if(t.targetTouches){var a=t.targetTouches[0];d=a.pageX,u=i}l=e,f=d-l.offsetLeft}function r(e){if(e.targetTouches){var i=e.targetTouches[0];d=i.pageX,l.style.left=i.pageX-f+"px";var n=e.originalEvent.touches[0].clientX;n>c?u=!1:n<c&&(u=!0),c=n}else{d=a.all?t.event.clientX:e.pageX,null!==l&&(l.style.left=d-f+"px");var r=e.pageX;r>c?u=!1:r<c&&(u=!0),c=r;var o=b(e,u),m=z.find("."+s.className+"-dot");m.removeClass("highlight"),m.eq(o).addClass("highlight")}}function o(e){if(l){var t=b(e,u),a=z.find("."+s.className+"-dot").eq(t);a.removeClass("highlight"),a.trigger("click"),l=null}}var c,l=null,d=0,f=0,u=!0;s.draggedElement?(e(s.draggedElement).on("mousedown touchstart",function(e){return n(z.find("."+s.className+"-timeline")[0],e),!1}),e(s.draggedElement).on("mousemove touchmove",function(e){r(e)}),e(s.draggedElement).on("mouseup touchend",function(e){o(e)})):(z.first().on("mousedown touchstart",function(e){return n(z.find("."+s.className+"-timeline")[0],e),!1}),e(a).on("mousemove.timeliny touchmove.timeliny",function(e){r(e)}),e(a).on("mouseup.timeliny touchend.timeliny",function(e){o(e)}))}function b(t,a){var i=0,n=z.find("."+s.className+"-vertical-line").offset().left,r=[];if(X.parent().find("."+s.className+"-timeblock:not(.inactive) ."+s.className+"-dot").each(function(t){var a=e(this).offset().left;r.push({currDotPos:a,index:t})}),t.targetTouches){var o=X.parent().find("."+s.className+"-timeblock.active").index();return w(n,r,a,i,o)}return w(n,r,a,i)}function k(e){var t=z.find("."+s.className+"-timeblock[data-year="+e+"]:not(.inactive) ."+s.className+"-dot").first();t.length>0&&t.trigger("click")}function w(e,t,a,i,n){if("undefined"!=typeof n){var s=t[n+1]?n+1:n,r=t[n-1]?n-1:n;return"undefined"==typeof a?n:a?s:r}var o;return t.some(function(t,n,s){var r=null;if(!s[n+1])return o=a?s[s.length-1].index:s[0].index,!0;r=s[n+1];var c=Math.abs(e-t.currDotPos),l=r.currDotPos-t.currDotPos,d=l/2,f=a?d-d*i:d+d*i,u=t.currDotPos<e&&e<r.currDotPos;return u?(o=c>=f?t.index+1:t.index,!0):void 0}),o}function x(e,t){return t?void(s[e]=t):s[e]}function C(){z.each(function(){var i=e(this);e(t).off("resize.timeliny"),i.find("."+s.className+"-timeblock:not(.inactive) ."+s.className+"-dot").off("click"),e(a).off("mousemove.timeliny"),e(a).off("mouseup.timeliny"),i.first().off("mousedown"),i.remove(),D("onDestroy"),i.removeData("plugin_timeliny")})}function D(e,t){s[e]!==i&&s[e].apply(T,t)}var T=n,z=e(n),X=z.children();return s=e.extend({},e.fn.timeliny.defaults,s),r(),{option:x,destroy:C,goToYear:k}}e.fn.timeliny=function(t){if(console.log(t),"string"==typeof arguments[0]){var a,s=arguments[0],r=Array.prototype.slice.call(arguments,1);return this.each(function(){if(!e.data(this,"plugin_timeliny")||"function"!=typeof e.data(this,"plugin_timeliny")[s])throw new Error("Method "+s+" does not exist on jQuery.timeliny");a=e.data(this,"plugin_timeliny")[s].apply(this,r)}),a!==i?a:this}if("object"==typeof t||!t)return this.each(function(){e.data(this,"plugin_timeliny")||e.data(this,"plugin_timeliny",new n(this,t))})},e.fn.timeliny.defaults={order:"asc",className:"timeliny",wrapper:'<div class="timeliny-wrapper"></div>',boundaries:2,animationSpeed:250,hideBlankYears:!1,onInit:function(){},onDestroy:function(){},afterLoad:function(e){},onLeave:function(e,t){},afterChange:function(e){},afterResize:function(){}}}(jQuery,window,document);